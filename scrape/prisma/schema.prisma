datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider             = "prisma-client-py"
  recursive_type_depth = 5
  interface            = "sync"
}

model vmware {
  cve      String @id
  synopsis String
  severity String
  date     String
  link     String
  detail   String
}

model cisco {
  id           String   @id
  link         String
  title        String
  impact       String
  version      String
  last_updated String
  clean_cves   String[]
}

model oracle {
  id                    Int    @id @default(autoincrement())
  affected_product      String
  affected_product_link String
  patch_document        String
  patch_document_link   String
}

model microsoft {
  cve           String @id
  release_date  String
  revision_date String
  cve_link      String
  cve_title     String
  impact        String
  severity      String
  tag           String
}

model hackernews {
  title       String @id
  link        String
  img         String
  date        String
  description String
  detail      String
}

// ============== START OF REDHAT ==============
model Redhat {
  id                String                 @id @unique @default(uuid())
  RHSA              String
  severity          String
  released_on       String
  CVEs              String[]
  bugzillas         String[]
  released_packages String[]
  resource_url      String
  document          Redhat_Document?
  vulnerabilities   Redhat_Vulnerability[]
}

model Redhat_Document {
  id                  String                      @id @unique @default(uuid())
  category            String
  csaf_version        String
  lang                String
  title               String
  aggregate_severity  Redhat_AggregateSeverity?
  distribution        Redhat_Distribution?
  publisher           Redhat_Publisher?
  notes               Redhat_Document_Note[]
  references          Redhat_Document_Reference[]
  redhat              Redhat?                     @relation(fields: [redhatId], references: [id], onDelete: Cascade)
  redhatId            String?                     @unique
  aggregateSeverityId String?
  distributionId      String?
  publisherId         String?
}

model Redhat_AggregateSeverity {
  id         String           @id @unique @default(uuid())
  namespace  String
  text       String
  document   Redhat_Document? @relation(fields: [documentId], references: [id], onDelete: Cascade)
  documentId String?          @unique
}

model Redhat_Distribution {
  id         String           @id @unique @default(uuid())
  text       String
  tlp        Redhat_Tlp?
  document   Redhat_Document? @relation(fields: [documentId], references: [id], onDelete: Cascade)
  documentId String?          @unique
  tlpId      String?          @unique
}

model Redhat_Tlp {
  id             String               @id @unique @default(uuid())
  label          String
  url            String
  distribution   Redhat_Distribution? @relation(fields: [distributionId], references: [id], onDelete: Cascade)
  distributionId String?              @unique
}

model Redhat_Document_Note {
  id         String           @id @unique @default(uuid())
  category   String
  text       String
  title      String
  document   Redhat_Document? @relation(fields: [documentId], references: [id], onDelete: Cascade)
  documentId String?
}

model Redhat_Publisher {
  id                String           @id @unique @default(uuid())
  category          String
  contact_details   String
  issuing_authority String
  name              String
  namespace         String
  document          Redhat_Document? @relation(fields: [documentId], references: [id], onDelete: Cascade)
  documentId        String?          @unique
}

model Redhat_Document_Reference {
  id         String           @id @unique @default(uuid())
  category   String
  summary    String
  url        String
  document   Redhat_Document? @relation(fields: [documentId], references: [id], onDelete: Cascade)
  documentId String?
}

model Redhat_Vulnerability {
  id             String                              @id @unique @default(uuid())
  cve            String
  discovery_date String
  ids            Redhat_Vulnerability_Id[]
  notes          Redhat_Vulnerability_Note[]
  product_status Redhat_Vulnerability_ProductStatus?
  references     Redhat_Vulnerability_Reference[]
  release_date   String
  remediations   Redhat_Vulnerability_Remediation[]
  scores         Redhat_Vulnerability_Score[]
  threats        Redhat_Vulnerability_Threat[]
  title          String
  cwe            Redhat_Vulnerability_Cwe?
  redhat         Redhat?                             @relation(fields: [redhatId], references: [id], onDelete: Cascade)
  redhatId       String
}

model Redhat_Vulnerability_Id {
  id              String                @id @unique @default(uuid())
  system_name     String
  text            String
  vulnerability   Redhat_Vulnerability? @relation(fields: [vulnerabilityId], references: [id], onDelete: Cascade)
  vulnerabilityId String?
}

model Redhat_Vulnerability_Note {
  id              String                @id @unique @default(uuid())
  category        String
  text            String
  title           String
  vulnerability   Redhat_Vulnerability? @relation(fields: [vulnerabilityId], references: [id], onDelete: Cascade)
  vulnerabilityId String?
}

model Redhat_Vulnerability_ProductStatus {
  id              String                @id @unique @default(uuid())
  fixed           String[]
  vulnerability   Redhat_Vulnerability? @relation(fields: [vulnerabilityId], references: [id], onDelete: Cascade)
  vulnerabilityId String?               @unique
}

model Redhat_Vulnerability_Reference {
  id              String                @id @unique @default(uuid())
  category        String
  summary         String
  url             String
  vulnerability   Redhat_Vulnerability? @relation(fields: [vulnerabilityId], references: [id], onDelete: Cascade)
  vulnerabilityId String?
}

model Redhat_Vulnerability_Remediation {
  id               String                                 @id @unique @default(uuid())
  category         String
  details          String
  product_ids      String[]
  url              String?
  vulnerability    Redhat_Vulnerability?                  @relation(fields: [vulnerabilityId], references: [id], onDelete: Cascade)
  vulnerabilityId  String
  restart_required Redhat_Vulnerability_RestartRequired[]
}

model Redhat_Vulnerability_RestartRequired {
  id            String                            @id @unique @default(uuid())
  category      String                            @default("")
  remediation   Redhat_Vulnerability_Remediation? @relation(fields: [remediationId], references: [id], onDelete: Cascade)
  remediationId String
}

model Redhat_Vulnerability_Score {
  id              String                       @id @unique @default(uuid())
  cvss_v3         Redhat_Vulnerability_CvssV3?
  products        String[]
  vulnerability   Redhat_Vulnerability?        @relation(fields: [vulnerabilityId], references: [id], onDelete: Cascade)
  vulnerabilityId String
}

model Redhat_Vulnerability_CvssV3 {
  id                    String                      @id @unique @default(uuid())
  attackComplexity      String
  attackVector          String
  availabilityImpact    String
  baseScore             Int
  baseSeverity          String
  confidentialityImpact String
  integrityImpact       String
  privilegesRequired    String
  scope                 String
  userInteraction       String
  vectorString          String
  version               String
  score                 Redhat_Vulnerability_Score? @relation(fields: [scoreId], references: [id], onDelete: Cascade)
  scoreId               String                      @unique
}

model Redhat_Vulnerability_Threat {
  id              String                @id @unique @default(uuid())
  category        String
  details         String
  vulnerability   Redhat_Vulnerability? @relation(fields: [vulnerabilityId], references: [id], onDelete: Cascade)
  vulnerabilityId String?
}

model Redhat_Vulnerability_Cwe {
  id              String                @id @unique @default(uuid())
  cweId           String
  name            String
  vulnerability   Redhat_Vulnerability? @relation(fields: [vulnerabilityId], references: [id], onDelete: Cascade)
  vulnerabilityId String?               @unique
}

// ============== END OF REDHAT ==============
